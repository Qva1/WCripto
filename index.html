<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>WCripto Wallet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#0b0f1a;color:#fff}
.container{max-width:420px;margin:auto;padding:15px}
.card{background:#131a2a;border-radius:12px;padding:15px;margin-bottom:15px}
button{width:100%;padding:12px;border:none;border-radius:8px;background:#1f80ff;color:#fff;font-size:16px;margin-top:8px;cursor:pointer}
input,select{width:100%;padding:10px;border-radius:6px;border:none;margin-top:8px}
.hidden{display:none}
.small{font-size:12px;color:#aaa}
.row{display:flex;justify-content:space-between;align-items:center}
hr{border:0;border-top:1px solid #222}
</style>
</head>
<body>

<div class="container">

<!-- LOGIN / REGISTRO -->
<div id="auth" class="card">
<h2>WCripto Wallet</h2>
<input id="email" placeholder="Correo">
<input id="password" type="password" placeholder="Contraseña">
<input id="bonus" placeholder="Código bono (opcional)">
<button onclick="register()">Registrarse</button>
<button onclick="login()">Entrar</button>
<p class="small">Bono válido: BONO20 (solo una vez)</p>
</div>

<!-- WALLET -->
<div id="wallet" class="hidden">

<div class="card">
<h3>Balance total</h3>
<h1 id="total">$0.00</h1>
</div>

<div class="card">
<h3>Activos</h3>
<div id="balances"></div>
</div>

<div class="card">
<button onclick="showDeposit()">Agregar fondos</button>
<button onclick="showSwap()">Swap</button>
<button onclick="showInvest()">Invertir (12 días +30%)</button>
<button onclick="logout()">Cerrar sesión</button>
</div>

<div class="card">
<h3>Historial</h3>
<div id="history"></div>
</div>

</div>

<!-- MODALES -->
<div id="modal" class="hidden card"></div>

</div>

<script>
/* ---------- DATA BASE ---------- */
const rates = { USDT:1, USDC:1, BTC:43000, SOL:110 }
const depositAddress = {
 USDT:"TXYZ-USDT-DEMO-123",
 USDC:"USDC-DEMO-456",
 BTC:"bc1-demo-btc",
 SOL:"SoL-demo-789"
}

/* ---------- HELPERS ---------- */
function save(u){localStorage.setItem("user",JSON.stringify(u))}
function load(){return JSON.parse(localStorage.getItem("user"))}
function logged(){return localStorage.getItem("logged")==="1"}
function updateUI(){
 const u=load()
 let total=0,html=""
 for(let c in u.balances){
  const v=u.balances[c]
  total+=v*rates[c]
  html+=`<div class="row"><span>${c}</span><b>${v.toFixed(4)}</b></div>`
 }
 document.getElementById("balances").innerHTML=html
 document.getElementById("total").innerText="$"+total.toFixed(2)

 let h=""
 u.history.forEach(x=>{
  h+=`<div class="small">${x}</div>`
 })
 document.getElementById("history").innerHTML=h||"Sin movimientos"
}

/* ---------- AUTH ---------- */
function register(){
 if(load()) return alert("Ya existe un usuario")
 const bonus=document.getElementById("bonus").value
 let balances={USDT:0,USDC:0,BTC:0,SOL:0}
 if(bonus==="BONO20"){
  balances.USDT=20
  localStorage.setItem("bonusUsed","1")
 }
 const user={
  email:email.value,
  pass:password.value,
  balances,
  investments:[],
  history:[bonus==="BONO20"?"Bono 20 USDT aplicado":"Registro creado"]
 }
 save(user); localStorage.setItem("logged","1")
 start()
}
function login(){
 const u=load()
 if(!u||u.pass!==password.value) return alert("Datos incorrectos")
 localStorage.setItem("logged","1")
 start()
}
function logout(){
 localStorage.removeItem("logged")
 location.reload()
}

/* ---------- UI ---------- */
function start(){
 document.getElementById("auth").classList.add("hidden")
 document.getElementById("wallet").classList.remove("hidden")
 updateUI()
}

/* ---------- DEPOSIT ---------- */
function showDeposit(){
 modal.innerHTML=`
 <h3>Agregar fondos</h3>
 <select id="coin">
  <option>USDT</option><option>USDC</option>
  <option>BTC</option><option>SOL</option>
 </select>
 <input id="amount" placeholder="Monto">
 <p id="addr" class="small"></p>
 <input id="code" placeholder="Código WhatsApp">
 <button onclick="confirmDeposit()">Confirmar</button>
 <button onclick="closeModal()">Cancelar</button>
 `
 modal.classList.remove("hidden")
 coin.onchange=()=>addr.innerText="Enviar a: "+depositAddress[coin.value]
 coin.onchange()
}
function confirmDeposit(){
 if(code.value!=="123456") return alert("Código incorrecto")
 const u=load()
 u.balances[coin.value]+=Number(amount.value)
 u.history.push(`Depósito ${amount.value} ${coin.value}`)
 save(u); closeModal(); updateUI()
}

/* ---------- SWAP ---------- */
function showSwap(){
 modal.innerHTML=`
 <h3>Swap</h3>
 <select id="from"><option>USDT</option><option>USDC</option><option>BTC</option><option>SOL</option></select>
 <select id="to"><option>USDT</option><option>USDC</option><option>BTC</option><option>SOL</option></select>
 <input id="amt" placeholder="Monto">
 <button onclick="doSwap()">Swap</button>
 <button onclick="closeModal()">Cancelar</button>`
 modal.classList.remove("hidden")
}
function doSwap(){
 const u=load()
 if(u.balances[from.value]<amt.value) return alert("Saldo insuficiente")
 const usd=amt.value*rates[from.value]
 const recv=usd/rates[to.value]
 u.balances[from.value]-=amt.value
 u.balances[to.value]+=recv
 u.history.push(`Swap ${amt.value} ${from.value} → ${recv.toFixed(4)} ${to.value}`)
 save(u); closeModal(); updateUI()
}

/* ---------- INVEST ---------- */
function showInvest(){
 modal.innerHTML=`
 <h3>Invertir</h3>
 <p class="small">12 días | +30%</p>
 <input id="inv" placeholder="Monto USDT">
 <button onclick="doInvest()">Invertir</button>
 <button onclick="closeModal()">Cancelar</button>`
 modal.classList.remove("hidden")
}
function doInvest(){
 const u=load()
 if(u.balances.USDT<inv.value||inv.value<5) return alert("Mínimo 5 USDT")
 u.balances.USDT-=inv.value
 const end=Date.now()+12*24*60*60*1000
 u.investments.push({amount:Number(inv.value),end})
 u.history.push(`Inversión ${inv.value} USDT`)
 save(u); closeModal(); updateUI()
}

/* ---------- MODAL ---------- */
function closeModal(){modal.classList.add("hidden")}

/* ---------- INIT ---------- */
if(logged()) start()
</script>
</body>
</html>
